character_event = {
	id = 110000
	picture = "GFX_evt_council"	
	
	hide_from = yes
	
	trigger = {
		ai = no 
		OR = {
			trait = not_dejure_liege
			has_minor_title = title_castellian
		}
	}
		
	desc = "EVTDESC110000"
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = "EVTOPTA110000"
		hidden_tooltip = {
			remove_trait = not_dejure_liege
			remove_title = title_castellian			
		}
	}
}

character_event = {
	id = 110001
	picture = "GFX_evt_council"	
	
	only_rulers = yes
	
	trigger = {
		primary_title = { tier = EMPEROR }
		any_demesne_title = {
			tier = KING
			empire = { holder_scope = { character = ROOT } }
			OR = {
				AND = {
					empire = { has_law = investiture_law_0 }
					NOT = { has_law = investiture_law_0 }
				}
				AND = {
					empire = { has_law = investiture_law_1 }
					NOT = { has_law = investiture_law_1 }
				}
				AND = {
					empire = { has_law = revoke_law_0 }
					NOT = { has_law = revoke_law_0 }
				}
				AND = {
					empire = { has_law = revoke_law_1 }
					NOT = { has_law = revoke_law_1 }
				}			
				AND = {
					empire = { has_law = centralization_0 }
					NOT = { has_law = centralization_0 }
				}
				AND = {
					empire = { has_law = centralization_1 }
					NOT = { has_law = centralization_1 }
				}	
				AND = {
					empire = { has_law = centralization_2 }
					NOT = { has_law = centralization_2 }
				}
				AND = {
					empire = { has_law = centralization_3 }
					NOT = { has_law = centralization_3 }
				}	
				AND = {
					empire = { has_law = centralization_4 }
					NOT = { has_law = centralization_4 }
				}				
			}
		}
	}
		
	desc = "EVTDESC110001"
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = "EVTOPTA110001"	
		any_demesne_title = {
			limit = {
				tier = KING
				empire = { holder_scope = { character = ROOT } }
				OR = {
					AND = {
						empire = { has_law = investiture_law_0 }
						NOT = { has_law = investiture_law_0 }
					}
					AND = {
						empire = { has_law = investiture_law_1 }
						NOT = { has_law = investiture_law_1 }
					}
					AND = {
						empire = { has_law = revoke_law_0 }
						NOT = { has_law = revoke_law_0 }
					}
					AND = {
						empire = { has_law = revoke_law_1 }
						NOT = { has_law = revoke_law_1 }
					}				
					AND = {
						empire = { has_law = centralization_0 }
						NOT = { has_law = centralization_0 }
					}
					AND = {
						empire = { has_law = centralization_1 }
						NOT = { has_law = centralization_1 }
					}	
					AND = {
						empire = { has_law = centralization_2 }
						NOT = { has_law = centralization_2 }
					}
					AND = {
						empire = { has_law = centralization_3 }
						NOT = { has_law = centralization_3 }
					}	
					AND = {
						empire = { has_law = centralization_4 }
						NOT = { has_law = centralization_4 }
					}					
				}			
			}
			if = {
				limit = {
					empire = { has_law = centralization_0 }
				}
				add_law_w_cooldown = centralization_0
			}
			if = {
				limit = {
					empire = { has_law = centralization_1 }
				}
				add_law_w_cooldown = centralization_1
			}
			if = {
				limit = {
					empire = { has_law = centralization_2 }
				}
				add_law_w_cooldown = centralization_2
			}
			if = {
				limit = {
					empire = { has_law = centralization_3 }
				}
				add_law_w_cooldown = centralization_3
			}
			if = {
				limit = {
					empire = { has_law = centralization_4 }
				}
				add_law_w_cooldown = centralization_4
			}
			if = {
				limit = {
					empire = { has_law = investiture_law_0 }
				}
				add_law_w_cooldown = investiture_law_0
			}
			if = {
				limit = {
					empire = { has_law = investiture_law_1 }
				}
				add_law_w_cooldown = investiture_law_1
			}
			if = {
				limit = {
					empire = { has_law = revoke_law_0 }
				}
				add_law_w_cooldown = revoke_law_0
			}
			if = {
				limit = {
					empire = { has_law = revoke_law_1 }
				}
				add_law_w_cooldown = revoke_law_1
			}			
		}
	}
}

character_event = {
	id = 110015
	
	trigger = {
		year = 1113
		has_landed_title = e_papal_state
		NOT = { has_global_flag = holy_orders_enabled }
	}
		
	desc = "EVTDESC110015"
	
	mean_time_to_happen = {
		months = 1		
	}
	

	option = {
		name = "EVTOPTA110015"
		set_global_flag = holy_orders_enabled		
		activate_title = { title = d_devotees_of_the_true_prophet status = yes }
		activate_title = { title = d_hashshashin status = yes }
	}
}

character_event = {
	id = 110017
	
	trigger = {
		ai = yes
		primary_title = { higher_tier_than = DUKE }
		OR = {
			num_of_duke_titles = 3	
			AND = {
				primary_title = { has_law = succ_feudal_elective }
				num_of_duke_titles = 2
			}
		}
		OR = {	
			any_realm_lord = {
				religion = ROOT
				is_liege_or_above = ROOT			
				any_demesne_title = {
					tier = COUNT					
					location = {
						duchy = {
							holder_scope = { character = ROOT }
							NOT = {
								ROOT = {
									capital_scope = {
										duchy = { title = PREVPREVPREV }
									}									
								}
							}
						}	
					}
				}				
			}
			any_demesne_title = {
				tier = COUNT
				location = {
					duchy = {
						holder_scope = { character = ROOT }
						NOT = {
							ROOT = {
								capital_scope = {
									duchy = { title = PREVPREVPREV }
								}									
							}
						}
					}
				}
			}			
		}
	}
		
	desc = "EVTDESC110017"
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = "EVTOPTA110017"
		hidden_tooltip = {
			#try to give it to a count with their capital in the duchy
			#give to lords with which we have a decent relationship first
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 50 }
					opinion = { who = ROOT value = 0 }
					primary_title = {
						tier = COUNT
					}
					capital_scope = {
						duchy = {
							holder_scope = { character = ROOT }
							NOT = {
								ROOT = {
									capital_scope = {
										duchy = { title = PREVPREVPREV }
									}									
								}
							}
						}				
					}
				}
				capital_scope = {
					duchy = {
						gain_title = PREVPREV
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 25 }
					opinion = { who = ROOT value = -25 }
					primary_title = {
						tier = COUNT
					}
					capital_scope = {
						duchy = {
							holder_scope = { character = ROOT }
							NOT = {
								ROOT = {
									capital_scope = {
										duchy = { title = PREVPREVPREV }
									}									
								}
							}
						}				
					}
				}
				capital_scope = {
					duchy = {
						gain_title = PREVPREV
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 0 }
					opinion = { who = ROOT value = -50 }
					primary_title = {
						tier = COUNT
					}
					capital_scope = {
						duchy = {
							holder_scope = { character = ROOT }
							NOT = {
								ROOT = {
									capital_scope = {
										duchy = { title = PREVPREVPREV }
									}									
								}
							}
						}				
					}
				}
				capital_scope = {
					duchy = {
						gain_title = PREVPREV
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					primary_title = {
						tier = COUNT
					}
					capital_scope = {
						duchy = {
							holder_scope = { character = ROOT }
							NOT = {
								ROOT = {
									capital_scope = {
										duchy = { title = PREVPREVPREV }
									}									
								}
							}
						}				
					}
				}
				capital_scope = {
					duchy = {
						gain_title = PREVPREV
					}
				}
				set_global_flag = duchy_granted
			}
			#try to give it to a count who has a province in the duchy
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 50 }
					opinion = { who = ROOT value = 0 }
					primary_title = {
						tier = COUNT
					}
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 25 }
					opinion = { who = ROOT value = -25 }
					primary_title = {
						tier = COUNT
					}
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 0 }
					opinion = { who = ROOT value = -50 }
					primary_title = {
						tier = COUNT
					}
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					primary_title = {
						tier = COUNT
					}
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}			
			#try to give it to a randomly generated character along with a count title in the duchy that we hold
			random_demesne_title = {
				limit = {
					tier = COUNT
					NOT = { has_global_flag = duchy_granted }
					location = {
						duchy = {
							holder_scope = { character = ROOT }
							NOT = {
								ROOT = {
									capital_scope = {
										duchy = { title = PREVPREVPREV }
									}									
								}
							}
						}	
					}
				}	
				ROOT = {
					create_random_steward = {
						random_traits = yes
						dynasty = random
						female = no
					}
					new_character = {
						character_event = { id = 300001 }					
						ROOT = {
							random_demesne_title = {
								limit = {
									tier = COUNT
									location = {
										duchy = {
											holder_scope = { character = ROOT }
											NOT = {
												ROOT = {
													capital_scope = {
														duchy = { title = PREVPREVPREV }
													}									
												}
											}
										}
									}
								}
								location = {
									set_province_flag = this_duchy
								}
							}
							random_demesne_province = {
								limit = {
									has_province_flag = this_duchy
								}
								county = {
									gain_title = PREVPREVPREV
								}
								duchy = {
									gain_title = PREVPREVPREV
								}
								clr_province_flag = this_duchy
							}
						}
					}
				}
				set_global_flag = duchy_granted
			}
			#if all else fails, give it to any vassal that has land in the duchy
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 50 }
					opinion = { who = ROOT value = 0 }
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}	
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 25 }
					opinion = { who = ROOT value = -25 }
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					reverse_opinion = { who = ROOT value = 0 }
					opinion = { who = ROOT value = -50 }
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}
			random_realm_lord = {
				limit = {
					NOT = { has_global_flag = duchy_granted }
					religion = ROOT
					is_liege_or_above = ROOT
					any_demesne_title = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
				}
				random_demesne_title = {
					limit = {
						tier = COUNT
						location = {
							duchy = {
								holder_scope = { character = ROOT }
								NOT = {
									ROOT = {
										capital_scope = {
											duchy = { title = PREVPREVPREV }
										}									
									}
								}
							}	
						}
					}
					location = {
						duchy = {
							gain_title = PREVPREVPREV
						}
					}
				}
				set_global_flag = duchy_granted
			}			
			clr_global_flag = duchy_granted	
			character_event = { id = 110017 }
		}
	}
}